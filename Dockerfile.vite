# docker/Dockerfile.vite
FROM node:20-alpine AS vite-builder

WORKDIR /app

# Install dependencies
COPY frontend/package*.json ./
RUN npm install

# Copy source and build
COPY frontend/ ./frontend
WORKDIR /app/frontend
RUN npm run build

# Final stage (for dev or CI if needed)
FROM node:20-alpine AS vite-dev

WORKDIR /app

# Copy deps from builder
COPY --from=vite-builder /app/node_modules ./node_modules
COPY --from=vite-builder /app/frontend ./frontend

CMD ["sh"]
